{"version":3,"file":"arktype.module.js","sources":["../src/arktype.ts"],"sourcesContent":["import { FieldError, FieldErrors } from 'react-hook-form';\nimport { toNestError, validateFieldsNatively } from '@hookform/resolvers';\nimport type { Resolver } from './types';\nimport { Problems } from 'arktype';\n\nconst parseErrorSchema = (e: Problems) => {\n  const errors: Record<string, FieldError> = {};\n  for (; e.length; ) {\n    const error = e[0];\n    const _path = error.path.join('.');\n\n    if (!errors[_path]) {\n      errors[_path] = { message: error.message, type: error.code };\n    }\n\n    // @ts-expect-error - false positive Property 'shift' does not exist on type 'Problems'.\n    e.shift();\n  }\n\n  return errors;\n};\n\nexport const arktypeResolver: Resolver =\n  (schema, _schemaOptions, resolverOptions = {}) =>\n  (values, _, options) => {\n    const result = schema(values);\n\n    if (result.problems) {\n      return {\n        values: {},\n        errors: toNestError(parseErrorSchema(result.problems), options),\n      };\n    }\n\n    options.shouldUseNativeValidation && validateFieldsNatively({}, options);\n\n    return {\n      errors: {} as FieldErrors,\n      values: resolverOptions.raw ? values : result.data,\n    };\n  };\n"],"names":["parseErrorSchema","e","errors","length","error","_path","path","join","message","type","code","shift","arktypeResolver","schema","_schemaOptions","resolverOptions","values","_","options","result","problems","toNestError","shouldUseNativeValidation","validateFieldsNatively","raw","data"],"mappings":"8EAKA,IAAMA,EAAmB,SAACC,GAExB,IADA,IAAMC,EAAqC,GACpCD,EAAEE,QAAU,CACjB,IAAMC,EAAQH,EAAE,GACVI,EAAQD,EAAME,KAAKC,KAAK,KAEzBL,EAAOG,KACVH,EAAOG,GAAS,CAAEG,QAASJ,EAAMI,QAASC,KAAML,EAAMM,OAIxDT,EAAEU,OACH,CAED,OAAOT,CACT,EAEaU,EACX,SAACC,EAAQC,EAAgBC,GAAoB,gBAApBA,IAAAA,EAAkB,CAAE,YAC5CC,EAAQC,EAAGC,GACV,IAAMC,EAASN,EAAOG,GAEtB,OAAIG,EAAOC,SACF,CACLJ,OAAQ,CAAA,EACRd,OAAQmB,EAAYrB,EAAiBmB,EAAOC,UAAWF,KAI3DA,EAAQI,2BAA6BC,EAAuB,GAAIL,GAEzD,CACLhB,OAAQ,CAAiB,EACzBc,OAAQD,EAAgBS,IAAMR,EAASG,EAAOM,MAElD,CAAC"}